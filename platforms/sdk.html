<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="stylesheet" href="/docs/assets/css/main.css" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script>
    (function(canonical) {
      if (document.location.href.substr(0, document.location.href.length - document.location.hash.length) !== canonical) {
        window.location.replace(canonical);
      }
    })('https://www.thethingsnetwork.org/docs/platforms/sdk.html');
    </script>
    <!-- Begin Jekyll SEO tag v2.2.3 -->
<title>Build an SDK | The Things Network</title>
<meta property="og:title" content="Build an SDK" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Build an SDK" />
<meta property="og:description" content="Build an SDK" />
<link rel="canonical" href="https://www.thethingsnetwork.org/docs/platforms/sdk.html" />
<meta property="og:url" content="https://www.thethingsnetwork.org/docs/platforms/sdk.html" />
<meta property="og:site_name" content="The Things Network" />
<meta property="og:image" content="https://www.thethingsnetwork.org/docs/assets/images/og-image.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-01-10T10:49:54+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@thethingsnetwrk" />
<meta property="article:publisher" content="https://www.facebook.com/thethingsnetwork" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"BlogPosting","headline":"Build an SDK","image":"https://www.thethingsnetwork.org/docs/assets/images/og-image.png","datePublished":"2018-01-10T10:49:54+00:00","dateModified":"2018-01-10T10:49:54+00:00","description":"Build an SDK","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ttnstaticfile.blob.core.windows.net/static/common/favicon/largetile.png"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.thethingsnetwork.org/docs/platforms/sdk.html"},"url":"https://www.thethingsnetwork.org/docs/platforms/sdk.html"}</script>
<!-- End Jekyll SEO tag -->
    <link rel="apple-touch-icon-precomposed" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-152.png">
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-144.png">
    <meta name="application-name" content="The Things Network">
    <meta name="msapplication-tooltip" content="Building a Global Internet of Things Network Together.">
    <meta name="msapplication-config" content="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/ieconfig.xml">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-32.png" sizes="32x32">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-57.png" sizes="57x57">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-76.png" sizes="76x76">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-96.png" sizes="96x96">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-120.png" sizes="120x120">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-128.png" sizes="128x128">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-144.png" sizes="144x144">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-152.png" sizes="152x152">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-180.png" sizes="180x180">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-195.png" sizes="195x195">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-228.png" sizes="228x228">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/smalltile.png" sizes="128x128">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/mediumtile.png" sizes="270x270">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/widetile.png" sizes="558x270">
    <link rel="icon" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/largetile.png" sizes="558x558">
    <link rel="shortcut icon" sizes="196x196" href="https://ttnstaticfile.blob.core.windows.net/static/common/favicon/favicon-196.png">
    <script src="/docs/assets/js/main.js"></script>
  </head>
  <body>
    <div id="content">
<div class="layout-page">
  <div class="ttn-header ttn-header-small">
    <div class="ttn-container container-fluid">
      <h1>
        <img src="/docs/assets/images/the-things-white.png" alt="⛅ The Things Network" />
        <span>Learn</span>
      </h1>
    </div>
  </div>
  <div class="container-fluid ttn-container">
    <div class="row page-top-nav">
      <div class="col-sm-9">
        <ul>
          <li class="page-top-nav-crumb"><a href="http://www.thethingsnetwork.org/">Home</a></li>
          <li class="page-top-nav-crumb"><a href="/docs/">Learn</a></li>
                <li class=""><a href="/docs/devices/">Devices</a></li>
                <li class=""><a href="/docs/gateways/">Gateways</a></li>
                <li class=""><a href="/docs/network/">Network</a></li>
                <li class=""><a href="/docs/applications/">Applications</a></li>
        </ul>
      </div>
      <div class="hidden-xs col-sm-3 text-right">
        <a href="https://github.com/TheThingsNetwork/docs/edit/master/_content/platforms/sdk.md" class="page-edit" data-proofer-ignore><i class="fa fa-github"></i> Edit <strong>sdk.md</strong></a>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-3">
        <div class="panel page-side-nav page-affix">
          <div class="panel-body">
            <h5>Platforms</h5>
            <ul>
              <li class=""><a href="/docs/platforms/index.html">Overview</a>
            <ul>
                <li class=""><a href="/docs/platforms/build/">Build an Integration</a>
                </li>
                <li class="active"><a href="/docs/platforms/sdk.html">Build an SDK</a>
                </li>
            </ul>
              </li>
                <li class="page-side-nav-section"><span>Links <i class="fa fa-link"></i></span>
                  <ul>
                      <li class=""><a href="/docs/platforms/../applications/options.html">Integration Options</a></li>
                      <li class=""><a href="/docs/platforms/../network/account/authentication.html#exchanging-an-access-key-for-an-access-token">Get an Access Token</a></li>
                      <li class=""><a href="/docs/platforms/../network/discovery/api.html#getall">Find an Handler Server</a></li>
                      <li class=""><a href="/docs/platforms/../applications/manager/">Manage Applications</a></li>
                      <li class=""><a href="/docs/platforms/../applications/mqtt/">Exchange Data</a></li>
                  </ul>
                </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-sm-7">
        <div class="panel">
          <div class="panel-body page-content">
            <h1 id="build-an-sdk">Build an SDK</h1>
<p>Devices and Applications exchange messages and events via the Handler’s MQTT broker. SDKs wrap this in a more friendly platform-specific API.</p>
<h2 id="examples">Examples</h2>
<p>Examples of libraries that wrap MQTT are the <a href="../applications/golang/">Go</a>, <a href="../applications/nodejs/">Node.js</a> and <a href="../applications/java/">Java</a> SDKs. The <a href="../applications/nodered/">Node-RED</a> Node actually is in fact another wrapper of the Node.js SDK.</p>
<h2 id="understanding-mqtt">Understanding MQTT</h2>
<p>It is important to have a good understanding of how MQTT in general and our broker specifically works. For more information, see the <a href="../applications/mqtt/">MQTT guide</a>.</p>
<p><strong>TL;DR:</strong> You authenticate to a local MQTT broker using an Application ID and Access Key. Subscribe to topics for messages and events coming from specific or any device registered to the application. Publish to a device’s downlink topic to send a message.</p>
<h2 id="building-a-sdk">Building a SDK</h2>
<h3 id="find-a-mqtt-client">Find a MQTT client</h3>
<p>You can find a <a href="https://github.com/mqtt/mqtt.github.io/wiki/libraries">MQTT client</a> for pretty much any language and platform. For example, the Node.js SDK uses <a href="https://www.npmjs.com/package/mqtt">MQTT.js</a>.</p>
<h3 id="abstract-connections">Abstract Connections</h3>
<p>To connect to the MQTT broker we need the broker URL, username and password. Instead of asking the user for the full URL including scheme (<code class="highlighter-rouge">mqtt</code> or <code class="highlighter-rouge">mqtts</code>) and port, the SDK should ask for the Application ID, Access Key (which act as username and password) plus a region of the community network to which the SDK should append <code class="highlighter-rouge">.thethings.network</code>. The user should still be able to provide the full hostname.</p>
<p>The constructor in pseudo code should look like:</p>
<div class="language-plaintext highlighter-rouge"><pre class="highlight"><code>client = new Client(region, appId, appAccessKey, [options])
</code></pre>
</div>
<p>See <a href="https://github.com/TheThingsNetwork/node-app-sdk/blob/master/src/client.js#L7-L11">how the Node.js SDK does this</a>.</p>
<h3 id="abstract-subscriptions">Abstract Subscriptions</h3>
<p>The <a href="../applications/mqtt/api.html">MQTT API</a> provides a whole range of topics you can subscribe to. Since constructing topic paths is not the most fun activity, the SDK should provide methods that take arguments and construct the paths for users.</p>
<p>These methods in pseudo code should look like:</p>
<div class="language-plaintext highlighter-rouge"><pre class="highlight"><code>client.on('message', [deviceId], [field], function(deviceId, message) {})

client.on('device', [deviceId], event, function(deviceId, message) {})
</code></pre>
</div>
<p>See how the Node.js SDK’s <a href="https://github.com/TheThingsNetwork/node-app-sdk/blob/master/src/client.js#L22-L46"><code class="highlighter-rouge">on/off()</code></a> methods use an <a href="https://github.com/TheThingsNetwork/node-app-sdk/blob/master/src/client.js#L85-L107"><code class="highlighter-rouge">_eventToTopic()</code></a> helper method to construct paths and another <a href="https://github.com/TheThingsNetwork/node-app-sdk/blob/master/src/client.js#L82"><code class="highlighter-rouge">_topicToEvent()</code></a> method to do the opposite upon <a href="https://github.com/TheThingsNetwork/node-app-sdk/blob/master/src/client.js#L82">receiving</a> a topic message.</p>
<h3 id="abstract-sending">Abstract Sending</h3>
<p>A user may send messages back to a device using the downlink MQTT topic. Again, the SDK should make this easier by providing a method to do so.</p>
<p>The method should look like:</p>
<div class="language-plaintext highlighter-rouge"><pre class="highlight"><code>client.send(deviceId, payload, [port])
</code></pre>
</div>
<p>The MQTT topic wants the raw payload base64 encoded and the payload fields JSON encoded. The SDK however, should accept an plain Array of bytes, Buffer or object of fields and handle the encoding.</p>
<p>See how the Node.js SDK handles this in its <a href="https://github.com/TheThingsNetwork/node-app-sdk/blob/master/src/client.js#L53-L60"><code class="highlighter-rouge">send()</code></a> method.</p>
<h2 id="consistency--parity">Consistency &amp; Parity</h2>
<p>Within the limitations of the platform language, always try to implement the full interface and keep the abstraction layer consistent across platforms. The <a href="../applications/nodejs/">Node.js</a> SDK is a good implementation to follow closely.</p>
          </div>
        </div>
      </div>
      <div class="hidden-xs col-sm-2">
        <div class="page-toc page-affix"></div>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="lightbox" tabindex="-1" role="dialog">
  <div class="modal-dialog text-center" role="document" style="width:auto;padding:20px;">
    <a href="https://ttnstaticfile.blob.core.windows.net/static/ttn/media/logo/ttn-logo.png"><img class="modal-content modal-body" src="https://ttnstaticfile.blob.core.windows.net/static/ttn/media/logo/ttn-logo.png" alt="Zoom" /></a>
  </div>
</div>
<script src="/docs/assets/js/page.js"></script>
    </div>
    <script src="https://www.thethingsnetwork.org/navbar.js"></script>
    <script src="https://ttnstaticfile.blob.core.windows.net/static/common/js/ga.js"></script>
  </body>
</html>
